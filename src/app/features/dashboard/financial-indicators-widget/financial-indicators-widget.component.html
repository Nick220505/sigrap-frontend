<p-card styleClass="h-full">
  <ng-template pTemplate="header">
    <div class="flex justify-between items-center px-4 py-2">
      <h2 class="text-xl font-semibold m-0">Indicadores Financieros</h2>
      <button
        pButton
        icon="pi pi-external-link"
        label="Ver Detallado"
        class="p-button-text p-button-sm"
        (click)="navigateToFinanceReport()"
        ariaLabel="Ver reporte financiero detallado"
      >
        <span>Ver Detallado</span>
      </button>
    </div>
  </ng-template>

  <div class="p-4">
    <div class="mb-5 grid grid-cols-2 gap-4">
      @for (metric of keyMetrics; track metric.label) {
        <div class="border rounded-lg p-3">
          <div class="flex justify-between items-start mb-2">
            <span class="text-sm text-gray-500">{{ metric.label }}</span>
            <div class="flex items-center">
              <i
                [ngClass]="{
                  'pi pi-arrow-up text-green-500': metric.change > 0,
                  'pi pi-arrow-down text-red-500': metric.change < 0,
                  'pi pi-minus text-gray-500': metric.change === 0,
                }"
                class="mr-1"
              ></i>
              <span
                [ngClass]="{
                  'text-green-500': metric.change > 0,
                  'text-red-500': metric.change < 0,
                  'text-gray-500': metric.change === 0,
                }"
                class="text-xs"
              >
                {{ Math.abs(metric.change) }}%
              </span>
            </div>
          </div>
          <div class="text-2xl font-bold">{{ metric.value }}</div>
        </div>
      }
    </div>

    <div class="mb-5">
      <h3 class="text-lg font-medium mb-3">Ingresos vs. Gastos</h3>
      <p-chart
        type="bar"
        [data]="incomeExpenseData"
        [options]="chartOptions"
        height="180"
      ></p-chart>
    </div>

    <div>
      <h3 class="text-lg font-medium mb-3">Distribuci√≥n de Gastos</h3>
      <p-chart
        type="doughnut"
        [data]="expenseDistributionData"
        [options]="doughnutOptions"
        height="200"
      ></p-chart>
    </div>
  </div>
</p-card>
