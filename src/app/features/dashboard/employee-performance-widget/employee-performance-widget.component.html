<p-card styleClass="h-full">
  <ng-template pTemplate="header">
    <div class="flex justify-between items-center px-4 py-2">
      <h2 class="text-xl font-semibold m-0">Desempeño de Empleados</h2>
      <div class="flex items-center gap-2">
        <p-dropdown
          [options]="periods"
          [(ngModel)]="selectedPeriod"
          optionLabel="label"
          optionValue="value"
          styleClass="p-dropdown-sm"
        ></p-dropdown>
        <button
          pButton
          icon="pi pi-external-link"
          class="p-button-text p-button-rounded p-button-sm"
          (click)="navigateToPerformanceReport()"
          pTooltip="Ver reporte completo"
          tooltipPosition="left"
          ariaLabel="Ver reporte completo de desempeño"
        >
          <span class="sr-only">Ver reporte completo</span>
        </button>
      </div>
    </div>
  </ng-template>

  <div class="p-4">
    <div class="overflow-x-auto">
      <table class="min-w-full">
        <thead>
          <tr class="border-b">
            <th class="text-left py-2 px-3 text-sm font-semibold text-gray-600">
              Empleado
            </th>
            <th
              class="text-center py-2 px-3 text-sm font-semibold text-gray-600"
            >
              Ventas
            </th>
            <th
              class="text-center py-2 px-3 text-sm font-semibold text-gray-600"
            >
              Meta
            </th>
            <th
              class="text-center py-2 px-3 text-sm font-semibold text-gray-600"
            >
              % Completado
            </th>
            <th
              class="text-center py-2 px-3 text-sm font-semibold text-gray-600"
            >
              Tickets
            </th>
            <th
              class="text-center py-2 px-3 text-sm font-semibold text-gray-600"
            >
              Evaluación
            </th>
          </tr>
        </thead>
        <tbody>
          @for (employee of employees; track employee.id) {
            <tr class="border-b hover:bg-gray-50">
              <td class="py-3 px-3">
                <div class="flex items-center gap-2">
                  <div
                    class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center"
                  >
                    <i class="pi pi-user text-gray-500"></i>
                  </div>
                  <div>
                    <div class="font-medium">{{ employee.name }}</div>
                    <div class="text-xs text-gray-500">
                      {{ employee.position }}
                    </div>
                  </div>
                </div>
              </td>
              <td class="py-3 px-3 text-center">
                {{
                  employee.sales | currency: 'COP' : 'symbol-narrow' : '1.0-0'
                }}
              </td>
              <td class="py-3 px-3 text-center">
                {{
                  employee.target | currency: 'COP' : 'symbol-narrow' : '1.0-0'
                }}
              </td>
              <td class="py-3 px-3">
                <div class="flex flex-col items-center">
                  <div class="w-full h-1.5 bg-gray-200 rounded-full mb-1">
                    <div
                      class="h-1.5 rounded-full"
                      [ngClass]="{
                        'bg-red-500': employee.completion < 50,
                        'bg-yellow-500':
                          employee.completion >= 50 && employee.completion < 80,
                        'bg-green-500': employee.completion >= 80,
                      }"
                      [ngStyle]="{ width: employee.completion + '%' }"
                    ></div>
                  </div>
                  <span class="text-xs">{{ employee.completion }}%</span>
                </div>
              </td>
              <td class="py-3 px-3 text-center">{{ employee.tickets }}</td>
              <td class="py-3 px-3 text-center">
                <p-rating
                  [ngModel]="employee.rating"
                  [readonly]="true"
                  [stars]="5"
                  styleClass="text-yellow-500"
                ></p-rating>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</p-card>
